(block cgagent
    (blockinherit subject_system_entry_template)

    (context bin_cgagent (sys.u sys.r bin_object (systemlow systemlow)))
    (filecon "/usr/lib/systemd/systemd-cgroups-agent" file bin_cgagent)

    (optional cgagent_optional_unconfined
        (call unconfined (common_subject)))
)

(macro cgagent_auto_subtrans ((type ARG1))
    (call auto_subject_type_transition_pattern
        (ARG1 cgagent.bin_object cgagent.common_subject)))
